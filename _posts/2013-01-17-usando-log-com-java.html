---
layout: post
title: Usando log com Java
date: 2013-01-17 18:25:00.000000000 -03:00
type: post
published: true
status: publish
categories:
- Código
- Dicas
- Java
- Tutorial
tags: []
meta:
  blogger_blog: www.edgardleal.com
  blogger_author: edgard leal
  blogger_permalink: "/2013/01/usando-log-com-java.html"
  blogger_internal: "/feeds/7525839575016029613/posts/default/2698476296201875648"
author:
  login: edgard leal
  email: ''
  display_name: edgard leal
  first_name: ''
  last_name: ''
---
<div dir="ltr" style="text-align: left">
<div style="text-align: center"><span><span style="font-size: large"><b>System.out.println(e.getMessage());</b></span></span></div>
<div style="text-align: center"></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small">Este é talves, o maior motivo para querer-mos utilizar uma ferramenta para gestão dos processos de log.</span></span></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small">Enquanto estamos desenvolvendo, é comum o uso do <u>sysout</u>, para registro e ate "depuração" do código, o problema começa quando o sistema vai para a produção e ocorrem erros misteriosos e o usuario nunca sabe realmente informar o que aconteceu.</span></span></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small"><br /></span></span></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small">O log4j propõe resolver este problema, não apenas registrando as mensagens em arquivos para encapsulando todo o processo que envolve os registros de log, como formatação das saidas, inclusão de data e hora, backup do log e outros.</span></span></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small"><br /></span></span></div>
<div style="text-align: left"><span style="font-size: small"><span style="font-family: inherit"><span style="font-family: Verdana,sans-serif">Para utilização desta API, basta fazer o download do arquivo .jar e adiciona-lo ao buildpath da aplicação.</span>&nbsp;</span></span></div>
<div style="text-align: left"></div>
<div style="text-align: left"><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><a href="http://www.apache.org/dyn/closer.cgi/logging/log4j/1.2.17/log4j-1.2.17.zip" target="_blank">Download do arquivo</a>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div>
<div style="clear: both;text-align: center"><a href="http://4.bp.blogspot.com/-WYGhEvOnVZw/UPhAZ88wmlI/AAAAAAAAB6o/TGiO9JVKrzE/s1600/buildpath1.PNG" style="margin-left: 1em;margin-right: 1em"><img border="0" height="265" src="{{ site.baseurl }}/assets/buildpath1.PNG" width="320" /></a></div>
<div style="clear: both;text-align: center"><a href="http://3.bp.blogspot.com/-2PbPBJpa-6c/UPhAZ87DlXI/AAAAAAAAB6w/ajwzU0k7J1k/s1600/buildpath2.PNG" style="margin-left: 1em;margin-right: 1em"><img border="0" height="259" src="{{ site.baseurl }}/assets/buildpath2.PNG" width="320" /></a><a href="http://1.bp.blogspot.com/--xUV8J58G_E/UPhAZx8kUYI/AAAAAAAAB6s/PmJGRhxY2u8/s1600/buildpath3.PNG" style="margin-left: 1em;margin-right: 1em"><img border="0" height="237" src="{{ site.baseurl }}/assets/buildpath3.PNG" width="320" /></a></div>
<div style="text-align: left"><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large">&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> </div>
<div style="text-align: left"></div>
<div style="text-align: left"><span style="font-size: small"><span style="font-family: Verdana,sans-serif">No caso de uma aplicação web, basta colar o arquivo na pasta "lib"&nbsp; do projeto.</span></span></p>
<pre>  <br />  BasicConfigurator.configure();<br />  Logger logger = Logger.getLogger(this.getClass());<br />  logger.info("Sistema iniciado");<br />  try {<br />     Thread.sleep(500);<br />  } catch (InterruptedException e) {<br />  }<br />  logger.warn("Mensagem de alerta");<br />  logger.error("Log de erro");<br /></pre>
</div>
<div style="text-align: left"></div>
<div style="text-align: left"><span style="font-size: small"><span style="font-family: inherit">Na primeira linha<span style="font-size: small">, foi usada uma <span style="font-size: small">configuração <span style="font-size: small">básica&nbsp;</span></span></span></span></span><br /><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">Na segunda linha iniciamos a classe que registra o log.</span></span></span></span></span><br /><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">Esta <span style="font-size: small">configuração não resol<span style="font-size: small">ve muita coisa porque apenas reg<span style="font-size: small">istra no console as <span style="font-size: small">saidas informadas<span style="font-size: small">:</span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">0 [localhost-startStop-1] INFO com.edgardleal.ClassTest&nbsp; - Sistema iniciado<br />500 [localhost-startStop-1] WARN </span></span></span></span></span></span></span></span></span></span><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">com.edgardleal.ClassTest</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp; - Mensagem de alerta<br />500 [localhost-startStop-1] ERROR <span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">com.edgardleal.ClassTest</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>&nbsp; - Log de erro</p>
<p>A primeira coluna indica o tempo decorrido deste a inicialização da classe Logger<br />2º Thread que esta sendo executada no momento<br />3º Nível do log<br />4º Classe que executou o log<br />5º Mensagem informada</p>
<p>Para que tenha-mos um log realmente útil precisaremos criar um arquivo de configurações para definirmos nossas preferencias e termos um resultado como o do exemplo abaixo:</p>
<p>INFO localhost-startStop-1 15:33:42.017 <span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">com.edgardleal.ClassTest</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> - Sistema iniciado<br />WARN localhost-startStop-1 15:33:42.517 <span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">com.edgardleal.ClassTest</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> - Mensagem de alerta<br />ERROR localhost-startStop-1 15:33:42.517 <span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small">com.edgardleal.ClassTest</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> - Log de erro<br /><span style="font-size: small"><span style="font-family: inherit"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"><span style="font-size: small"></span></span></span></span></span></span></span></span></span></span> </p>
<p></div>
<div style="text-align: left">Crie um arquivo com o nome "log.properties" com o seguinte coneudo:</p>
<p>
<pre>  log4j.rootLogger=DEBUG, sysout<br />  log4j.appender.sysout=org.apache.log4j.RollingFileAppender<br />  log4j.appender.sysout.layout=org.apache.log4j.PatternLayout<br />  log4j.appender.sysout.File=log.txt<br />  log4j.appender.sysout.File=log.txt<br />  log4j.appender.sysout.File=log.txt<br />  log4j.appender.sysout.layout.ConversionPattern=%p %t %d{HH:mm:ss.SSS} %c - %m%n<br />  log4j.appender.sysout.MaxFileSize=5KB<br />  log4j.appender.sysout.MaxBackupIndex=2<br /></pre>
</div>
<div style="text-align: left"><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><br /></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family: Verdana,sans-serif"><span style="font-size: small">1º Nome o layout de configuração</span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">2º Tipo de layout utilizado ( o arquivo continua crescendo ) </span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">3º Formatação utilizada, neste caso, utilizaremos o padrão informado abaixo</span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">4º Nome do arquivo de log</span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">5º Mascara utilizada para gerar o resultado</span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">6º Tamanho máximo do arquivo de log</span></span><br /><span style="font-family: Verdana,sans-serif"><span style="font-size: small">7º Número máximo de backups mantidos</span></span><br /><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large">&nbsp;</span></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div>
<div style="text-align: left"></div>
<div style="text-align: left"><span style="font-family: Verdana,sans-serif"><span style="font-size: small">E alteramos o código anterior para que fique da seguinte forma:</span></span></p>
<pre>  PropertyConfigurator.configure("log.properties");<br />  Logger logger = Logger.getLogger(this.getClass());<br />  logger.info("Sistema iniciado");<br />  try {<br />   Thread.sleep(500);<br />  } catch (InterruptedException e) {<br />  }<br />  logger.warn("Mensagem de alerta");<br />  logger.error("Log de erro");<br /></pre>
<p><span><span style="font-size: large"><span style="font-size: large"><span style="font-family: inherit"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large"><span style="font-size: large">&nbsp;</span></span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span><b> </b></div>
<p><span style="font-size: small"><span style="font-family: inherit">Na primeir<span style="font-size: small">a linha do código<span style="font-size: small">, iniciamos a configuração global do log com o <span style="font-size: small">arquivo </span></span></span></span></span>"log.properties"</p>
<p><a href="http://logging.apache.org/log4j/1.2/manual.html" target="_blank">Veja a documentação completa</a></p>
<p></div>
